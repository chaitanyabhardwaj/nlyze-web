<!DOCTYPE html><html lang="en-US" dir="ltr"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" /><title>NLYZE | Factory Model</title><meta name="description" content="" /><meta name="owner" content="Nakul Malhotra"><meta name="author" content="Chaitanya Bhardwaj" /><base href="reportmachine.html" target="_self" /><meta name="referrer" content="origin-when-cross-origin" /><link rel="icon" type="image/x-icon" href="/resources/favicon_title.png" /><meta name="robots" content="index, nofollow">
<link rel="stylesheet" type="text/css" href="lib/bootstrap-4/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="stylesheets/index-large.css">
<link rel="stylesheet" type="text/css" href="stylesheets/reportmachine-large.css">
<script src="scripts/jquery-3.2.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="lib/bootstrap-4/js/bootstrap.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-functions.js"></script>
<script src="/scripts/main.js"></script>
<script src="/scripts/productchecker.js"></script>
<script src="/scripts/inspector.js"></script>
<script src="scripts/Chart.bundle.min.js"></script>
<script src="scripts/financesettings.js"></script>
<script src="scripts/machinesettings.js"></script>
<script src="scripts/manpowersettings.js"></script>
<script>
	
	'use strict';

	//Initializing ReportMachine
	function ReportMachine(user) {
		const inst = this;
		this.userRef = user;
		//Initialize firestore
		this.db = firebase.firestore();

		//STATIC COLORS ARRAY
		this.paintBox = ["Aqua","Aquamarine","Black","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGreen","DarkMagenta","DarkOliveGreen","Darkorange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DodgerBlue","FireBrick","ForestGreen","Fuchsia","Gold","GoldenRod","Gray","Green","GreenYellow","HotPink","IndianRed","Indigo","LawnGreen","LightBlue","LightCoral","LightGoldenRodYellow","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGrey","LightSteelBlue","Lime","LimeGreen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MistyRose","Moccasin","NavajoWhite","Navy","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","Yellow","YellowGreen"];
		//machinefile constants
		this.machineStandardHours = 5404;

		//get DOM shortcuts
		this.currentOEEDOM = $('.oee-current-value');
		this.currentPRDOM = $('.pr-current-value');
		this.visionOEEDOM = $('.oee-vision-value');
		this.visionPRDOM = $('.pr-vision-value');
		this.oeeChangeStrDOM = $('.oee-increase-str');
		this.prChangeStrDOM = $('.pr-increase-str');
		this.oeeChangeValueDOM = $('.oee-increase-value');
		this.prChangeValueDOM = $('.pr-increase-value');
		this.oeeArrow = $('.oee-arrow img');
		this.prArrow = $('.pr-arrow img');

		this.referencePeriod = $('.reference-period-select');
		this.line = $('.line-select');
		this.referencePeriodValue = this.referencePeriod.val();
		this.lineValue = this.line.val();

		this.paretoOption1 = $('.pareto-option-1');
		this.paretoOption2 = $('.pareto-option-2');
		this.paretoOption3 = $('.pareto-option-3');
		this.paretoGraphContainer = $('.pareto-graph-canvas-container');

		//set event listeners
		this.referencePeriod.change(function() {
			inst.onComponentChanged();
		});
		this.line.change(function() {
			inst.onComponentChanged();
		});
		
		this.paretoOption1.click(function() {
			if(inst.paretoOption1.text() === 'Losses' && inst.paretoOption2.text() === 'Family') {
				inst.paretoOption1.text('Potentials');
				inst.initParetoGraph(inst.getParetoDataSet());
				return;
			}
			if(inst.paretoOption1.text() === 'Potentials' && inst.paretoOption2.text() === 'Family') {
				inst.paretoOption1.text('Losses');
				inst.initParetoGraph(inst.getParetoDataSet());
				return;
			}
		});
		this.paretoOption2.click(function() {
			if(inst.paretoOption2.text() === 'Family' && inst.paretoOption1.text() === 'Potentials') {
				inst.paretoOption2.text('Loss');
				inst.initParetoGraph(inst.getParetoDataSet());
				return;
			}
			if(inst.paretoOption2.text() === 'Loss') {
				inst.paretoOption2.text('Family');
				inst.initParetoGraph(inst.getParetoDataSet());
				return;
			}
		});
		this.paretoOption3.click(function() {
			if(inst.paretoOption3.text() === '(H Mac)')
				inst.paretoOption3.text('(kUSD)');
			else
				inst.paretoOption3.text('(H Mac)');
			inst.initParetoGraph(inst.getParetoDataSet());
		});

		//Calling init functions
		this.initLayout();
	};

	ReportMachine.prototype.initLayout = function() {
		//clear existing data
		$('input').val('');
		$('select').find('option.data-option').remove();
		//fetch referencePeriod
		this.initReferencePeriod();
		//fetch line data
		this.initLines();
	};

	ReportMachine.prototype.initGraphs = function() {
		this.initGraphicRepresentationGraph();
		this.initReferenceVisionGraph();
		this.initParetoGraph(this.getParetoDataSet());
	};

	ReportMachine.prototype.initDataLayout = function() {
		this.displayKPIData();
	};

	ReportMachine.prototype.initReferencePeriod = function() {
		this.db.collection('users/' + this.userRef.uid + '/products/np002/factoryFileTypes/machine/referencePeriod/').get().then(querySnapshot => {
			querySnapshot.forEach(ref => {
				$("<option class='data-option' value='" + ref.id + "'>").appendTo(".reference-period-select").text(ref.id);
			});
		}).catch(err => {
			console.log(err);
		});
	};

	ReportMachine.prototype.initLines = function() {
		this.db.collection('users/' + this.userRef.uid + '/products/np002/areaLayout').get().then(querySnapshot => {
			querySnapshot.forEach(area => {
				$("<option class='data-option' value='" + area.data().line + "'>").appendTo(".line-select").text(area.data().line);
			});
		}).catch(err => {
			console.log(err);
		});	
	};

	ReportMachine.prototype.initParetoFamily = function() {
		//Called after pulling familyData
		$.each(this.machinesettings.famArr, (i, fam) => {
			$("<option class='data-option' value='" + fam.name + "'>").appendTo(".family-select").text(fam.displayName);
		});
	};

	ReportMachine.prototype.calLossData = function() {
		//pulled after pulling LossesData
		this.lossArr = [];
		const lossHeader = this.machinesettings.lossesHeaderArr[1].data().name;
		$.each(this.machinesettings.lossesArr, (i, l) => {
			this.lossArr[i] = l.data()[lossHeader];
		});
	};

	ReportMachine.prototype.calkUSDData = function() {
		this.kUSDDataArr = [];
		var j;
		const totalEnergyArr = this.getFinanceTotalEnergy();
		const totalAccountingCostArr = this.getTotalAccountingCost();
		const totalManpowerCostArr = this.getTotalManpowerCost();
		//cal total manpower cost arr from accounting and manpower cost
		const totalFinanceArr = [];
		$.each(this.financesettings.lineArr, (i,line) => {
			//get total accounting cost for this line
			sum = 0;
			for(j = 0; j < totalAccountingCostArr.length; j++) {
				if(totalAccountingCostArr[j].line === line) {
					sum = totalAccountingCostArr[j].value;
					break;
				}
			}
			if(sum == 0) {
				for(j = 0; j < totalManpowerCostArr.length; j++) {
					if(totalManpowerCostArr[j].line === line) {
						sum = totalManpowerCostArr[j].value;
						break;
					}
				}
			}
			totalFinanceArr[i] = {
				line : line,
				value : sum
			};
		});
		const opDollarArr = this.getOpDollarArr(totalFinanceArr);
		const enDollarArr = this.getEnDollarArr(totalEnergyArr, opDollarArr);
		//cal kusdData
		$.each(this.machinesettings.famArr, (i, fam) => {
			this.kUSDDataArr[fam] = opDollarArr[fam] + enDollarArr[fam];
		});
	};

	ReportMachine.prototype.getOpDollarArr = function(totalFinanceArr) {
		const hmacByFamilyArr = this.getLossesTotalByFamilyInHmac();
		const hmacByFamilyByLineArr = this.getLossesTotalByLineByFamilyInHmac();
		const opDollarArr = [];
		var sum = 0;
		if(this.lineValue == 0) {
			//get sum of totalFinanceArr
			$.each(totalFinanceArr, (i, data) => {
				sum += data.value;
			});
			$.each(this.machinesettings.famArr, (i, fam) => {
				opDollarArr[fam] = hmacByFamilyArr[fam] * sum / 1000;
			});
		}
		else {
			//get sum of totalFinanceArr By Line
			$.each(totalFinanceArr, (i, data) => {
				if(data.line === this.lineValue) {
					sum += data.value;
				}
			});
			$.each(this.machinesettings.famArr, (i, fam) => {
				opDollarArr[fam] = hmacByFamilyByLineArr[fam] * sum / 1000;
			});
		}
		return opDollarArr;
	};

	ReportMachine.prototype.getEnDollarArr = function(totalEnergyArr, opDollarArr) {
		const enDollarArr = [];
		var sumOp = 0, sum = 0;
		if(this.lineValue == 0) {
			//get totalEnergyArr total
			$.each(totalEnergyArr, (i, data) => {
				sum += data.value;
			});
		}
		else {
			//get totalEnergyArr total by line
			$.each(totalEnergyArr, (i, data) => {
				if(data.line === this.lineValue) {
					sum += data.value;
				}
			});
		}
		//get opDollar Total
		$.each(opDollarArr, (i,data) => {
			sumOp += data;
		});
		//cal enDollar Arr
		$.each(this.machinesettings.famArr, (i, fam) => {
			enDollarArr[fam] = opDollarArr[fam] * sum / sumOp;
		});
		return enDollarArr;
	};

	ReportMachine.prototype.getFinanceTotalEnergy = function() {
		//get finance headers
		const lineHeaderName = this.financesettings.lossesHeaderArr[0];
		const totalEnergyArr = [];
		var sum, k, energyHeaderName;
		//range -> 1 to header.length - 4 = all energy headers
		$.each(this.financesettings.lineArr, (i, line) => {
			sum = 0;
			$.each(this.financesettings.lossesArr, (j, loss) => {
				if(line === loss.data()[lineHeaderName]) {
					for(k = 1; k < this.financesettings.lossesHeaderArr.length - 3; k++) {
						energyHeaderName = this.financesettings.lossesHeaderArr[k];
						sum += parseFloat(loss.data()[energyHeaderName].replace(/,/g, ''));
					}
				}
			});
			totalEnergyArr[i] = {
				line : line,
				value : sum
			};
		});
		return totalEnergyArr;
	};

	ReportMachine.prototype.getTotalManpowerCost = function() {
		const financeLossesHeader = this.financesettings.lossesHeaderArr;
		const lineHeaderNameF = financeLossesHeader[0];
		const hourlyLabourCostHeaderName = financeLossesHeader[financeLossesHeader.length - 3];
		const totalManpowerArr = [];
		const manningNormArr = this.getTotalManningNorm();
		var sum, k;
		$.each(this.financesettings.lineArr, (i, line) => {
			sum = 0;
			$.each(this.financesettings.lossesArr, (j, loss) => {
				if(line === loss.data()[lineHeaderNameF]) {
					sum += parseFloat(loss.data()[hourlyLabourCostHeaderName].replace(/,/g, ''));
				}
			});
			for(k = 0; k < manningNormArr.length; k++) {
				if(manningNormArr[k].line === line) {
					sum *= manningNormArr[k].value;
					break;
				}
			}
			totalManpowerArr[i] = {
				line : line,
				value : sum
			};
		});
		return totalManpowerArr;
	};

	ReportMachine.prototype.getTotalAccountingCost = function() {
		const financeLossesHeader = this.financesettings.lossesHeaderArr;
		const lineHeaderName = financeLossesHeader[0];
		const totalAccountingCostHeaderName = financeLossesHeader[financeLossesHeader.length - 2];
		const totalAccountingCostArr = [];
		var sum;
		$.each(this.financesettings.lineArr, (i, line) => {
			sum = 0;
			$.each(this.financesettings.lossesArr, (j, loss) => {
				if(line === loss.data()[lineHeaderName]) {
					sum += parseFloat(loss.data()[totalAccountingCostHeaderName].replace(/,/g, ''));
				}
			});
			totalAccountingCostArr[i] = {
				line : line,
				value : sum
			};
		});
		return totalAccountingCostArr;	
	};

	ReportMachine.prototype.getTotalManningNorm = function() {
		const manpowerLossesHeader = this.manpowersettings.lossesHeaderArr;
		const lineHeaderNameM = manpowerLossesHeader[0];
		const manningNormHeaderName = manpowerLossesHeader[2];
		const manningNormArr = [];
		var sum;
		$.each(this.manpowersettings.lineArr, (i, line) => {
			sum = 0;
			$.each(this.manpowersettings.lossesArr, (j, loss) => {
				if(line === loss.data()[lineHeaderNameM]) {
					sum += parseFloat(loss.data()[manningNormHeaderName].replace(/,/g, ''));
				}
			});
			manningNormArr[i] = {
				line : line,
				value : sum
			};
		});
		return manningNormArr;
	};

	ReportMachine.prototype.getCurrentUtilisationTotal = function() {
		var sum = 0;
		const utilisationHeader = this.machinesettings.refPHeaderArr[2].data().name;
		$.each(this.machinesettings.refPArr, (i, data) => {
			sum += parseInt(data.data()[utilisationHeader].replace(/,/g, ''));
		});
		return sum;
	};

	ReportMachine.prototype.getCurrentOpeningTimeTotal = function() {
		var sum = 0;
		$.each(this.machinesettings.currentOpeningTimeArr, (i, data) => {
			sum += data.value;
		});
		return sum;
	};

	ReportMachine.prototype.getCurrentTheoreticalTimeTotal = function() {
		var sum = 0;
		const theoreticalTimeHeaderName = this.machinesettings.refPHeaderArr[4].data().name;
		$.each(this.machinesettings.refPArr, (i, data) => {
			sum += parseInt(data.data()[theoreticalTimeHeaderName].replace(/,/g, ''));
		});
		return sum;
	};

	ReportMachine.prototype.getAfterVisionUtilisationTotal = function() {
		var sum = 0;
		$.each(this.machinesettings.afterVisionUtilisationArr, (i, data) => {
			sum += data;
		});
		return sum;
	};

	ReportMachine.prototype.getAfterVisionOpeningTimeTotal = function() {
		var sum = 0;
		$.each(this.machinesettings.afterVisionOpeningTimeArr, (i,data) => {
			sum += data.value;
		});
		return sum;
	};

	ReportMachine.prototype.getCurrentUtilisationTotalByLine = function() {
		var sum = 0;
		const utilisationHeader = this.machinesettings.refPHeaderArr[2].data().name;
		const lineHeaderName = this.machinesettings.refPHeaderArr[0].data().name;
		$.each(this.machinesettings.refPArr, (i, data) => {
			if(this.lineValue === data.data()[lineHeaderName])
			sum += parseInt(data.data()[utilisationHeader].replace(/,/g, ''));
		});
		return sum;
	};

	ReportMachine.prototype.getCurrentOpeningTimeTotalByLine = function() {
		var sum = 0;
		$.each(this.machinesettings.currentOpeningTimeArr, (i,data) => {
			if(this.lineValue === data.line)
				sum += data.value;
		});
		return sum;
	};

	ReportMachine.prototype.getCurrentTheoreticalTimeTotalByLine = function() {
		var sum = 0;
		const theoreticalTimeHeaderName = this.machinesettings.refPHeaderArr[4].data().name;
		const lineHeaderName = this.machinesettings.refPHeaderArr[0].data().name;
		$.each(this.machinesettings.refPArr, (i,data) => {
			if(data.data()[lineHeaderName] === this.lineValue)
				sum += parseInt(data.data()[theoreticalTimeHeaderName].replace(/,/g, ''));
		});
		return sum;
	};

	ReportMachine.prototype.getAfterVisionUtilisationTotalByLine = function() {
		var sum = 0;
		const lineHeaderName = this.machinesettings.refPHeaderArr[0].data().name;
		$.each(this.machinesettings.refPArr, (i, data) => {
			if(this.lineValue === data.data()[lineHeaderName])
				sum += this.machinesettings.afterVisionUtilisationArr[i];
		});
		return sum;
	};

	ReportMachine.prototype.getAfterVisionOpeningTimeTotalByLine = function() {
		var sum = 0;
		$.each(this.machinesettings.afterVisionOpeningTimeArr, (i,data) => {
			if(this.lineValue === data.line)
				sum += data.value;
		});
		return sum;
	};

	ReportMachine.prototype.getOEECurrent = function() {
		if(this.lineValue == 0)
			return (this.getCurrentTheoreticalTimeTotal() / this.getCurrentOpeningTimeTotal() * 100);
		return (this.getCurrentTheoreticalTimeTotalByLine() / this.getCurrentOpeningTimeTotalByLine() * 100);
	};

	ReportMachine.prototype.getPRCurrent = function() {
		if(this.lineValue == 0)
			return (this.machineStandardHours / this.getCurrentOpeningTimeTotal() * 100);
		return (this.machineStandardHours / this.getCurrentOpeningTimeTotalByLine() * 100);
	};

	ReportMachine.prototype.getOEEVision = function() {
		if(this.lineValue == 0)
			return (this.getCurrentTheoreticalTimeTotal() / this.getAfterVisionOpeningTimeTotal() * 100);
		return (this.getCurrentTheoreticalTimeTotalByLine() / this.getAfterVisionOpeningTimeTotalByLine() * 100);
	};

	ReportMachine.prototype.getPRVision = function() {
		if(this.lineValue == 0)
			return (this.machineStandardHours / this.getAfterVisionOpeningTimeTotal() * 100);
		return (this.machineStandardHours / this.getAfterVisionOpeningTimeTotalByLine() * 100);
	};

	ReportMachine.prototype.getLossesTotalInHmac = function() {
		//hmac total = lossesHeaderArr(id = 5)
		var sum = 0;
		const headerName = this.machinesettings.lossesHeaderArr[3].data().name;
		for(var i = 0; i < this.machinesettings.lossesArr.length; i++)
			sum += parseFloat(this.machinesettings.lossesArr[i].data()[headerName].replace(/,/g, ''));
		return sum;
	};

	//By line
	ReportMachine.prototype.getLossesTotalByLineInHmac = function() {
		//hmac total = lossesHeaderArr(id = 5)
		var sum = 0;
		const headerName = this.machinesettings.lossesHeaderArr[3].data().name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].data().name;
		for(var i = 0; i < this.machinesettings.lossesArr.length; i++) {
			if(this.machinesettings.lossesArr[i].data()[lineHeader] === this.lineValue)
				sum += parseFloat(this.machinesettings.lossesArr[i].data()[headerName].replace(/,/g, ''));
		}
		return sum;
	};

	ReportMachine.prototype.getLossesTotalInKusd = function() {
		//kUSD total = lossesHeaderArr.headersArr(id = 8)
		var sum = 0;
		const headerName = this.machinesettings.lossesHeaderArr[8].data().name;
		for(var i = 0; i < this.machinesettings.lossesArr.length; i++)
			sum += parseFloat(this.machinesettings.lossesArr[i].data()[headerName].replace(/,/g, ''));
		return sum;
	};

	//By line
	ReportMachine.prototype.getLossesTotalByLineInKusd = function() {
		//kUSD total = lossesHeaderArr(id = 8)
		var sum = 0;
		const headerName = this.machinesettings.lossesHeaderArr[8].data().name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].data().name;
		for(var i = 0; i < this.machinesettings.lossesArr.length; i++) {
			if(this.machinesettings.lossesArr[i].data()[lineHeader] === this.lineValue)
				sum += parseFloat(this.machinesettings.lossesArr[i].data()[headerName].replace(/,/g, ''));
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalInHmac = function() {
		//hmac total = lossesHeaderArr(id = 5)
		var sum = 0;
		for(var i = 0; i < this.machinesettings.potentialsArr.length; i++) {
			sum += (this.machinesettings.potentialsArr[i].value);
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineInHmac = function() {
		//hmac total = potentialsHeaderArr(id = 1)
		var sum = 0;
		for(var i = 0; i < this.machinesettings.potentialsArr.length; i++) {
			if(this.machinesettings.potentialsArr[i].line === this.lineValue)
				sum += (this.machinesettings.potentialsArr[i].value);
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		var sum = 0;
		for(var i = 0; i < this.machinesettings.kUSDPotentialsArr.length; i++)
			sum += (this.machinesettings.kUSDPotentialsArr[i].value);
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		var sum = 0;
		for(var i = 0; i < this.machinesettings.kUSDPotentialsArr.length; i++) {
			if(this.machinesettings.kUSDPotentialsArr[i].line === this.lineValue)
				sum += (this.machinesettings.kUSDPotentialsArr[i].value);
		}
		return sum;
	};

	ReportMachine.prototype.getLossesTotalByFamilyInHmac = function() {
		//hmac total = lossesHeaderArr(id = 5)
		const hmacHeaderName = this.machinesettings.lossesHeaderArr[3].data().name;
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		var familyName;
		var sum = [];
		//Initialize sum with familyName as index
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.lossesArr.length; j++) {
				if(this.machinesettings.lossesArr[j].data()[famHeaderName] !== undefined) {
					if(familyName === this.machinesettings.lossesArr[j].data()[famHeaderName].toLowerCase()) {
						sum[familyName] += parseFloat(this.machinesettings.lossesArr[j].data()[hmacHeaderName].replace(/,/g, ''));
					}
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getLossesTotalByLineByFamilyInHmac = function() {
		//hmac total = lossesHeaderArr(id = 5)
		const hmacHeaderName = this.machinesettings.lossesHeaderArr[3].data().name;
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].data().name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.lossesArr.length; j++) {
				if(this.machinesettings.lossesArr[j].data()[famHeaderName] !== undefined || this.machinesettings.lossesArr[j].data()[lineHeader] !== undefined) {
					if(this.machinesettings.lossesArr[j].data()[lineHeader] === this.lineValue && familyName === this.machinesettings.lossesArr[j].data()[famHeaderName].toLowerCase()) {
						sum[familyName] += parseFloat(this.machinesettings.lossesArr[j].data()[hmacHeaderName].replace(/,/g, ''));
					}
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.getLossesTotalByFamilyInKusd = function() {
		//kUSD total = lossesHeaderArr(id = 8)
		const kusdHeaderName = this.machinesettings.lossesHeaderArr[8].data().name;
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.lossesArr.length; j++) {
				if(this.machinesettings.lossesArr[j].data()[famHeaderName] !== undefined) {
					if(familyName === this.machinesettings.lossesArr[j].data()[famHeaderName].toLowerCase()) {
						sum[familyName] += parseFloat(this.machinesettings.lossesArr[j].data()[kusdHeaderName].replace(/,/g, ''));
					}
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getLossesTotalByLineByFamilyInKusd = function() {
		//kUSD total = lossesHeaderArr(id = 8)
		const kusdHeaderName = this.machinesettings.lossesHeaderArr[8].data().name;
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].data().name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.lossesArr.length; j++) {
				if(this.machinesettings.lossesArr[j].data()[famHeaderName] !== undefined || this.machinesettings.lossesArr[j].data()[lineHeader] !== undefined) {
					if(this.machinesettings.lossesArr[j].data()[lineHeader] === this.lineValue && familyName === this.machinesettings.lossesArr[j].data()[famHeaderName].toLowerCase()) {
						sum[familyName] += parseFloat(this.machinesettings.lossesArr[j].data()[kusdHeaderName].replace(/,/g, ''));
					}
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalByFamilyInHmac = function() {
		//hmac total = potentialsHeaderArr(id = 1)
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.potentialsArr.length; j++) {
				if(familyName === this.machinesettings.lossesArr[j].data()[famHeaderName]) {
					sum[familyName] += parseFloat(this.machinesettings.potentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineByFamilyInHmac = function() {
		//hmac total = potentialsHeaderArr(id = 1)
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].data().name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].data().name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.potentialsArr.length; j++) {
				if(this.machinesettings.potentialsArr[j].line === this.lineValue && familyName === this.machinesettings.lossesArr[j][famHeaderName]) {
					sum[i] += parseFloat(this.machinesettings.potentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalByFamilyInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.kUSDPotentialsArr.length; j++) {
				if(familyName === this.machinesettings.lossesArr[j][famHeaderName]) {
					sum[familyName] += parseFloat(this.machinesettings.kUSDPotentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineByFamilyInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		const famHeaderName = this.machinesettings.lossesHeaderArr[2].name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].name;
		var familyName;
		var sum = [];
		for(var i = 0; i < this.machinesettings.famArr.length; i++) {
			familyName = this.machinesettings.famArr[i].name;
			sum[familyName] = 0;
			for(var j = 0; j < this.machinesettings.kUSDPotentialsArr.length; j++) {
				if(this.machinesettings.kUSDPotentialsArr[j].line === this.lineValue && familyName === this.machinesettings.lossesArr[j][famHeaderName]) {
					sum[i] += parseFloat(this.machinesettings.kUSDPotentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalByLossInHmac = function() {
		//hmac total = potentialsHeaderArr(id = 1)
		const lossHeaderName = this.machinesettings.lossesHeaderArr[1].data().name;
		var lossName;
		var sum = [];
		for(var i = 0; i < this.lossArr.length; i++) {
			lossName = this.lossArr[i];
			sum[lossName] = 0;
			for(var j = 0; j < this.machinesettings.potentialsArr.length; j++) {
				if(lossName === this.machinesettings.lossesArr[j].data()[lossHeaderName]) {
					sum[lossName] += parseFloat(this.machinesettings.potentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineByLossInHmac = function() {
		//hmac total = potentialsHeaderArr(id = 1)
		const lossHeaderName = this.machinesettings.lossesHeaderArr[1].name;
		const lineHeader = this.machinesettings.lossesHeaderArr[0].name;
		var lossName;
		var sum = [];
		for(var i = 0; i < this.lossArr.length; i++) {
			lossName = this.lossArr[i];
			sum[lossName] = 0;
			for(var j = 0; j < this.machinesettings.potentialsArr.length; j++) {
				if(this.machinesettings.potentialsArr[j].line === this.lineValue && lossName === this.machinesettings.lossesArr[j][lossHeaderName]) {
					sum[i] += parseFloat(this.machinesettings.potentialsArr[j].value);
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.getPotentialsTotalByLossInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		const lossHeaderName = this.machinesettings.lossesHeaderArr[1].name;
		var lossName;
		var sum = [];
		for(var i = 0; i < this.lossArr.length; i++) {
			lossName = this.lossArr[i];
			sum[lossName] = 0;
			for(var j = 0; j < this.machinesettings.kUSDPotentialsArr.length; j++) {
				if(lossName === this.machinesettings.lossesArr[j][lossHeaderName]) {
					sum[lossName] += parseFloat(this.machinesettings.kUSDPotentialsArr.value);
				}
			}
		}
		return sum;
	};

	//By line
	ReportMachine.prototype.getPotentialsTotalByLineByLossInKusd = function() {
		//kUSD total = potentialsHeaderArr(id = 4)
		const lossHeaderName = this.machinesettings.lossesHeaderArr[1].name;
		const lineHeader = this.machinesettings.lossesHeaderArr.headersArr[0].name;
		var lossName;
		var sum = [];
		for(var i = 0; i < this.lossArr.length; i++) {
			lossName = this.lossArr[i];
			sum[lossName] = 0;
			for(var j = 0; j < this.machinesettings.kUSDPotentialsArr.length; j++) {
				if(this.machinesettings.kUSDPotentialsArr[j].line === this.lineValue && lossName === this.machinesettings.lossesArr[j][lossHeaderName]) {
					sum[i] += parseFloat(this.machinesettings.kUSDPotentialsArr.value);
				}
			}
		}
		return sum;
	};

	ReportMachine.prototype.displayKPIData = function() {
		//get current oee and current pr
		const oeeCurrent = this.getOEECurrent();
		const prCurrent = this.getPRCurrent();
		//display matEff and waste current
		this.displayOEECurrent(oeeCurrent.toFixed(2));
		this.displayPRCurrent(prCurrent.toFixed(2));
		//get vision oee and vision pr
		const oeeVision = this.getOEEVision();
		const prVision = this.getPRVision();
		//display matEff and wasteVision
		this.displayOEEVision(oeeVision.toFixed(2))
		this.displayPRVision(prVision.toFixed(2));
		//display change oee and change pr
		this.displayOEEChange(oeeCurrent, oeeVision);
		this.displayPRChange(prCurrent, prVision);
	};

	ReportMachine.prototype.displayOEECurrent = function(oee) {
		this.currentOEEDOM.text(oee + '%');
	};

	ReportMachine.prototype.displayPRCurrent = function(pr) {
		this.currentPRDOM.text(pr + '%');
	};

	ReportMachine.prototype.displayOEEVision = function(oee) {
		this.visionOEEDOM.text(oee + '%');
	};

	ReportMachine.prototype.displayPRVision = function(pr) {
		this.visionPRDOM.text(pr + '%');
	};

	ReportMachine.prototype.displayOEEChange = function(oeeCurrent, oeeVision) {
		var change;
		if(oeeVision >= oeeCurrent) {
			change = oeeVision - oeeCurrent;
			this.oeeChangeStrDOM.val('Increase');
			this.oeeArrow.attr('src','resources/up_arrow_green.png');
		}
		else {
			change = oeeCurrent - oeeVision;
			this.oeeChangeStrDOM.val('Decrease');
			this.oeeArrow.attr('src','resources/down_arrow_red.png');
		}
		this.oeeChangeValueDOM.text(change.toFixed(2) + '%');
	};

	ReportMachine.prototype.displayPRChange = function(prCurrent, prVision) {
		var change;
		if(prVision >= prCurrent) {
			change = prVision - prCurrent;
			this.prChangeStrDOM.val('Increase');
			this.prArrow.attr('src','resources/up_arrow_green.png');
		}
		else {
			change = prCurrent - prVision;
			this.prChangeStrDOM.val('Decrease');
			this.prArrow.attr('src','resources/down_arrow_red.png');
		}
		this.prChangeValueDOM.text(change.toFixed(2) + '%');
	};

	ReportMachine.prototype.initGraphicRepresentationGraph = function() {
		const inst = this;
		const ctx = document.getElementsByClassName("graphic-repersentation-graph-canvas")[0].getContext('2d');
		const gradientGreen = ctx.createLinearGradient(0, 0, 0, 100); 
    	gradientGreen.addColorStop(1, 'rgba(70, 147, 43, 1)');
    	gradientGreen.addColorStop(0, 'rgba(177, 231, 90, 1)');
    	const gradientRed = ctx.createLinearGradient(0, 0, 0, 100); 
    	gradientRed.addColorStop(0, 'rgba(236, 77, 93, 1)');
    	gradientRed.addColorStop(1, 'rgba(159, 15, 35, 1)');
    	const gradientYellow = ctx.createLinearGradient(0, 0, 0, 250); 
    	gradientYellow.addColorStop(1, 'rgba(249, 115, 106, 1)');
    	gradientYellow.addColorStop(0, 'rgba(242, 171, 128, 1)');

    	var currentOpeningTime, afterVisionOpeningTime, theoreticalTime, lossesTotal, potentialsTotal, currentUtilisation, afterVisionUtilisation;
    	if(this.lineValue == 0) {
    		currentOpeningTime = this.getCurrentOpeningTimeTotal();
    		afterVisionOpeningTime = this.getAfterVisionOpeningTimeTotal();
    		theoreticalTime = this.getCurrentTheoreticalTimeTotal();
    		lossesTotal = this.getLossesTotalInHmac();
    		potentialsTotal = this.getPotentialsTotalInHmac();
    		currentUtilisation = this.getCurrentUtilisationTotal();
    		afterVisionUtilisation = this.getAfterVisionUtilisationTotal();
    	}
    	else {
    		currentOpeningTime = this.getCurrentOpeningTimeTotalByLine();
    		afterVisionOpeningTime = this.getAfterVisionOpeningTimeTotalByLine();
    		theoreticalTime = this.getCurrentTheoreticalTimeTotalByLine();
    		lossesTotal = this.getLossesTotalByLineInHmac();
    		potentialsTotal = this.getPotentialsTotalByLineInHmac();
    		currentUtilisation = this.getCurrentUtilisationTotalByLine();
    		afterVisionUtilisation = this.getAfterVisionUtilisationTotalByLine();
    	}

		const chart = new Chart(ctx, {
			type : 'bar',
			data : {
				labels : ['Reference', 'Vision'],
				datasets : [{
					label : ['Opening Time'],
					data : [currentOpeningTime.toFixed(2), afterVisionOpeningTime.toFixed(2)],
					borderColor : '#696969',
					pointBackgroundColor : 'rgba(255,255,255,1)',
					pointBorderColor : 'rgba(245,245,245,1)',
					pointHoverBackgroundColor : 'rgba(255,255,255,1)',
					pointHoverBorderColor : 'rgba(235,235,235,1)',
					pointRadius : 4,
					pointHoverRadius : 5,
					fill : false,
					type : 'line'
				},
				{
					label : ['Theoretical Time'],
					data : [theoreticalTime, theoreticalTime],
					backgroundColor : [gradientGreen, gradientGreen],
					borderColor : [gradientGreen, gradientGreen]
				},
				{
					label : ['H Mac'],
					data : [lossesTotal.toFixed(2), potentialsTotal.toFixed(2)],
					backgroundColor : [gradientRed, gradientRed],
					borderColor : [gradientRed, gradientRed]
				},
				{
					label : ['Utilisation'],
					data : [currentUtilisation, afterVisionUtilisation],
					backgroundColor : [gradientYellow, gradientYellow],
					borderColor : [gradientYellow, gradientYellow]
				}]
			},
			options: {
				responsive : true,
				hover : { mode : null},
				maintainAspectRatio : false,
				showAllTooltips: false, 
				legend : { display : false },
        		scales : {
    				xAxes: [{
    					stacked : true,
    					ticks : {
    						fontColor : '#696969',
    						fontSize : 9,
    					},
                		gridLines: {
                    		display: false,
                    		drawBorder : false
                		}
            		}],
    				yAxes: [{
    					stacked : true,
    					ticks : {
    						display : true,
    						min : 0,
    						fontSize : 10,
    						fontColor : '#696969'
    					},
                		gridLines: {
                			display: true,
                			drawBorder : false
                		}   
            		}]
    			},
    			tooltips : {
    				titleFontSize : 8,
    				backgroundColor : 'rgba(0,0,0,0.4)',
    				bodyFontColor : '#fff',
    				bodyFontSize : 8,
    				bodyFontStyle : 'light',
    			},
    		}
		});
	};

	ReportMachine.prototype.initReferenceVisionGraph = function() {
		const inst = this;
		const ctx = document.getElementsByClassName("reference-vision-graph-canvas")[0].getContext('2d');
		const gradientLine = ctx.createLinearGradient(0, 0, 0, 100); 
    	gradientLine.addColorStop(0, 'rgba(0, 119, 255, 1)');
    	gradientLine.addColorStop(1, 'rgba(0, 242, 254, 1)');

    	var lossesTotal, potentialsTotal;

    	if(this.lineValue == 0) {
    		lossesTotal = this.getLossesTotalInHmac();
    		potentialsTotal = this.getPotentialsTotalInHmac();
    	}
    	else {
    		lossesTotal = this.getLossesTotalByLineInHmac();
    		potentialsTotal = this.getPotentialsTotalByLineInHmac();
    	}

		const chart = new Chart(ctx, {
			type : 'bar',
			data : {
				labels : ['Reference', 'Vision'],
				datasets : [{
					label : [''],
					data : [potentialsTotal.toFixed(2), lossesTotal.toFixed(2)],
					borderColor : gradientLine,
					pointBackgroundColor : 'rgba(255,255,255,1)',
					pointBorderColor : 'rgba(245,245,245,1)',
					pointHoverBackgroundColor : 'rgba(255,255,255,1)',
					pointHoverBorderColor : 'rgba(235,235,235,1)',
					pointRadius : 4,
					pointHoverRadius : 5,
					fill : false,
					type : 'line'
				},
				{
					label : [''],
					data : [lossesTotal.toFixed(2),potentialsTotal.toFixed(2)],
					backgroundColor : [
						'rgba(52,58,64,1)',
						'rgba(52,58,64,1)'
					],
					borderColor : [
						'rgba(52,58,64,1)',
						'rgba(52,58,64,1)',
					],
					borderWidth : 1.5,
				},
				{
					label : [''],
					data : [0,(lossesTotal - potentialsTotal).toFixed(2)],
					backgroundColor : [
						'rgba(92,98,104,1)',
						'rgba(92,98,104,1)'
					],
					borderColor : [
						'rgba(92,98,104,1)',
						'rgba(92,98,104,1)'
					],
					borderWidth : 1.5,
				}]
			},
			options: {
				responsive : true,
				maintainAspectRatio : false,
				showAllTooltips: false, 
				legend : { display : false },
        		scales : {
    				xAxes: [{
    					stacked : true,
    					ticks : {
    						fontColor : '#696969',
    						fontSize : 9
    					},
                		gridLines: {
                    		display:false,
                    		drawBorder : false
                		}
            		}],
    				yAxes: [{
    					stacked : true,
    					ticks : {
    						display : true,
    						min : 0,
    						fontSize : 10,
    					},
                		gridLines: {
                			display : true,
                			drawBorder : false,
                		}   
            		}]
    			},
    			tooltips : {
    				titleFontSize : 8,
    				backgroundColor : 'rgba(0,0,0,0.4)',
    				bodyFontColor : '#fff',
    				bodyFontSize : 8,
    				bodyFontStyle : 'light',
    			},
    		}
		});
	};

	ReportMachine.prototype.initParetoGraph = function(dataArr) {
		const inst = this;
		const canvas = $('.pareto-graph-canvas');
		canvas.remove() //TO CLEAR THE CANVAS
		$("<canvas class='pareto-graph-canvas'>").appendTo('.pareto-graph-canvas-container')
		const ctx = document.getElementsByClassName("pareto-graph-canvas")[0].getContext('2d');
		ctx.canvas.height = 380;
		var dataNameArr = [], dataColorArr = [];
		if(this.paretoOption2.text() === 'Family') {
			dataNameArr = this.machinesettings.famArr.map(a => a.name.toUpperCase());
			dataColorArr = this.machinesettings.famArr.map(b => b.color); 
		}
		else {
			dataNameArr = this.lossArr;
			const colors = this.getColors(dataNameArr.length)
			//for(var i = 0; i < colors.length; i++)
			//	dataColorArr[i] = 'rgb(' + colors[i].r + ',' + colors[i].g + ',' + colors[i].b + ')';
			dataColorArr = colors;
		}
		//convert dataArr array
		const newDataArr = [], newLabelArr = [];
		var i = 0, maxValue = 0;
		for(var key in dataArr) {
			newLabelArr[i] = key;
			newDataArr[i++] = dataArr[key];
			if(maxValue < dataArr[key])
				maxValue = dataArr[key];
		}

		console.log(newLabelArr);
		console.log(newDataArr);

		const chart = new Chart(ctx, {
			type : 'bar',
			data : {
				labels : newLabelArr,
				datasets : [{
					label : inst.paretoUnit,
					data : newDataArr,
					backgroundColor : dataColorArr,
					hoverBackgroundColor : dataColorArr,
					borderColor : dataColorArr,
					hoverBorderColor : '#777',
					borderWidth : 1,
				}]
			},
			options: {
				responsive : true,
				maintainAspectRatio : false,
				showAllTooltips: false, 
				legend : { display : false },
        		scales : {
    				xAxes: [{
    					stacked : true,
    					ticks : {
    						fontColor : '#696969',
    						fontSize : 5,
    						autoSkip : false
    					},
                		gridLines: {
                    		display:false,
                    		drawBorder : false
                		}
            		}],
    				yAxes: [{
    					stacked : true,
    					ticks : {
    						display : true,
    						stepSize : (maxValue / 4),
    						max : (maxValue + parseInt(maxValue / 4)),
    						fontSize : 8,
    					},
                		gridLines: {
                			display : true,
                			drawBorder : true,
                		}   
            		}]
    			},
    			tooltips : {
    				yAlign : 'bottom',
    				titleFontSize : 8,
    				backgroundColor : 'rgba(0,0,0,0.4)',
    				bodyFontColor : '#fff',
    				bodyFontSize : 8,
    				bodyFontStyle : 'light',
    				footerFontColor : '#f2f2f2',
    				displayColors : true
    			},
    		}
		});
	};

	ReportMachine.prototype.getParetoLossesByFamilyInHmac = function() {
		console.log(this.getLossesTotalByFamilyInHmac());
		return this.getLossesTotalByFamilyInHmac();
	};

	ReportMachine.prototype.getParetoLossesByFamilyInKusd = function() {
		return this.getLossesTotalByFamilyInKusd();
	};

	ReportMachine.prototype.getParetoPotentialsByFamilyInHmac = function() {
		return this.getPotentialsTotalByFamilyInHmac();
	};

	ReportMachine.prototype.getParetoPotentialsByFamilyInKusd = function() {
		return this.getPotentialsTotalByFamilyInKusd();
	};

	ReportMachine.prototype.getParetoPotentialsByLossInHmac = function() {
		return this.getPotentialsTotalByLossInHmac();
	};

	ReportMachine.prototype.getParetoPotentialsByLossInKusd = function() {
		return this.getPotentialsTotalByLossInKusd();
	};

	ReportMachine.prototype.getParetoDataSet = function() {
		if(this.paretoOption1.text() === 'Losses') {
			//paretoOption2 in this case will always be 'Family'
			if(this.paretoOption3.text() === '(H Mac)') {
				this.paretoUnit = 'H Mac';
				return this.getParetoLossesByFamilyInHmac();
			}
			//else
			this.paretoUnit = 'kUSD';
			return this.getParetoLossesByFamilyInKusd();
		}
		//else
		//paretoOption1 in this case is 'Potentials'
		if(this.paretoOption2.text() === 'Family') {
			if(this.paretoOption3.text() === '(H Mac)') {
				this.paretoUnit = 'H Mac';
				return this.getParetoPotentialsByFamilyInHmac();
			}
			//else
			this.paretoUnit = 'kUSD';
			return this.getParetoPotentialsByFamilyInKusd();
		}
		//esle
		//paretoOption2 in this case is 'Loss'
		if(this.paretoOption3.text() === '(H Mac)') {
			this.paretoUnit = 'H Mac';
			return this.getParetoPotentialsByLossInHmac();
		}
		//else
		this.paretoUnit = 'kUSD';
		return this.getParetoPotentialsByLossInKusd();
	};

	ReportMachine.prototype.onComponentChanged = function() {
		const inst = this;
		this.referencePeriodValue = this.referencePeriod.find(':selected').val();
		this.lineValue = this.line.find(':selected').val();
		if(this.referencePeriodValue != 0) {
			this.financesettings = new FinanceSettings(this.userRef, this.referencePeriodValue);
			this.manpowersettings = new ManpowerSettings(this.userRef, this.referencePeriodValue);
			this.machinesettings = new MachineSettings(this.userRef, this.referencePeriodValue);
			const constructF = this.financesettings.constructLayout();
			const constructM = this.manpowersettings.constructLayout();
			const construct = this.machinesettings.constructLayout();
			Promise.all([constructF, constructM, construct]).then(result => {
				//init paretoFamilt
				inst.initParetoFamily();
				inst.calLossData();
				inst.calkUSDData();
				inst.initDataLayout();
				inst.initGraphs();
			}).catch(err => {
				console.log(err);
			});
		}
	};

	ReportMachine.prototype.getColors = function(num) {
		const colors = [];
		for(var i = 0; i < num; i++) {
			colors[i] = this.paintBox[i];
		}
		return colors;
	};

	//FUCNTION TO DISPLAY TEXT DIALOG AT THE TOP
	function displayDialog(msg, dialogType) {
		$('html, body').scrollTop(0);
		var dialogBox = $('.alert-' + dialogType);
		if(dialogBox.length === 0) //dialogBox with class 'dialogType' does not exists
			dialogBox =$('.alert-warning');
		dialogBox.html(msg);
		dialogBox.fadeIn();
		var timer = setInterval(function() {
			dialogBox.fadeOut();
			clearInterval(timer);
		}, 4000);
	};

	$(document).ready(function() {
		firebase.auth().onAuthStateChanged(function(user) {
			if(user) {
				//User is signed in
				const inspector = new Inspector(user);
				inspector.checkDisabled();
				const reportMachine = new ReportMachine(user);
			}
			else {
				
			}
		});
	});

</script>
</head><body>
	<div class="outer-wrapper container-fluid"></div>
	<div class="outer-container">
		<div class="alert alert-success dialog-box text-center"></div>
		<div class="alert alert-warning dialog-box text-center"></div>
		<div class="alert alert-danger dialog-box text-center"></div>
		<div class="header-container container-fluid">
			<header class="container-fluid row">
				<div class="container slider-button-container col-1">
					<div class="container slider-button header-item">
						<img src="resources/side_bar_slider.png" alt="SLIDE" class="side-bar-slider">
					</div>
				</div>
				<div class="container nav-container col-11">
					<nav class="container row">
						<div class="container col-11">
							<ul class="nav">
								<li class="nav-item top-nav-item header-item">
									<a href="/products/factorymodal/" class="nav-link text-muted"><small>Overview</small></a>
								</li>
								<li class="nav-item top-nav-item top-nav-item-active header-item">
									<a class="nav-link active"><small>Analytics</small></a>
								</li>
							</ul>
						</div>
						<div class="container header-item col-1">
							<div class="d-inline-block m-2 float-right dropdown">
								<i class="fa fa-chevron-circle-down text-primary d-block dropdown-toggle" data-toggle="dropdown" style="font-size: 170%;"></i>
								<div class="dropdown-menu">
									<a href="/products.html" class="dropdown-item text-medium text-low">Home</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-medium text-low" id="nav-signout-icon">Sign Out</a>
								</div>
							</div>
						</div>
					</nav>
				</div>
			</header>
		</div>
		<div class="side-bar-container">
			<ul class="nav flex-column">
				<li class="nav-item side-nav-item">
					<a href="analyticslayout.html" class="nav-link p-2">
						<img src="resources/analytics_side_bar.png" class="opacity-5" alt="Analytics">
					</a>
				</li>
				<li class="nav-item side-nav-item">
					<a class="nav-link p-2 active side-nav-item-active">
						<img src="resources/reports_side_bar.png" alt="Reports">
					</a>
				</li>
				<li class="nav-item side-nav-item">
					<a href="coststructure.html" class="nav-link p-2">
						<img src="resources/cost_structure_side_bar.png" class="opacity-5" alt="Cost Structure">
					</a>
				</li>
				<li class="nav-item side-nav-item">
					<a href="masterplan.html" class="nav-link p-2">
						<img src="resources/masterplan_side_bar.png" class="opacity-5" alt="Masterplan">
					</a>
				</li>
			</ul>
		</div>
		<div class="main-container pt-0 pr-0">
			<main>
				<div class="container-fluid section bg-light pl-5 pr-0" id="section-1">
					<div class="border-bottom p-4">
						<div class="d-inline-block font-weight-bold h5 mr-5">
							Reports
						</div>
						<div class="d-inline-block mx-2">
							<select class="reference-period-select select-type-input bg-primary text-white text-medium p-1 px-2 rounded font-weight-light d-block">
								<option value="0">Reference Period</option>
							</select>
						</div>
						<div class="d-inline-block mx-2">
							<select class="line-select select-type-input bg-primary text-white text-medium p-1 px-2 rounded font-weight-light d-block">
								<option value="0">Line</option>
								<option value="1">All Lines</option>
							</select>
						</div>
					</div>
					<div class="border-bottom py-1 px-4">
						<ul class="nav nav-justified">
							<li class="nav-item">
								<a class="nav-link text-danger text-small font-weight-bold" href="/products/factorymodal/reportmachine.html">MACHINE</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportenergy.html">ENERGY</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportmaterial.html">MATERIAL</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportmanpower.html">MANPOWER</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportmaintaince.html">MAINTAINCE</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportvolume.html">VOLUME</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/reportfinance.html">FINANCE</a>
							</li>
							<li class="nav-item">
								<a class="nav-link text-small text-muted font-weight-bold" href="/products/factorymodal/settings.html">SETTINGS</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="container">
					<div class="row my-4">
						<div class="col-6">
							<div class="row my-1">
								<div class="col-6">
									<div class="card bg-dark">
										<div class="card-head mt-1">
											<div class="container text-white text-small">OEE(Current)</div>
										</div>
										<div class="card-body pb-4">
											<div class="oee-current-value text-center text-white font-weight-light">0%</div>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="card bg-dark">
										<div class="card-head mt-1">
											<div class="container text-white text-small">PR(Current)</div>
										</div>
										<div class="card-body pb-4">
											<div class="pr-current-value text-center text-white font-weight-light">0%</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row my-3">
								<div class="col-6">
									<div class="card bg-dark">
										<div class="card-head mt-1">
											<div class="container text-white text-small">OEE(Vision)</div>
										</div>
										<div class="card-body pb-4">
											<div class="oee-arrow representing-arrow">
												<img src="resources/up_arrow_green.png">
											</div>
											<div class="oee-vision-value text-center text-white font-weight-light">0%</div>
											<div class="text-center text-white text-extra-small font-weight-light"><span class="oee-increase-str">Increase</span> by <span class="oee-increase-value">0%</span></div>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="card bg-dark">
										<div class="card-head mt-1">
											<div class="container text-white text-small">PR(Vision)</div>
										</div>
										<div class="card-body pb-4">
											<div class="pr-arrow representing-arrow">
												<img src="resources/up_arrow_green.png">
											</div>
											<div class="pr-vision-value text-center text-white font-weight-light">0%</div>
											<div class="text-center text-white text-extra-small font-weight-light"><span class="pr-increase-str">Increase</span> by <span class="pr-increase-value">0%</span></div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-6">
							<div class="row my-1">
								<div class="col-6">
									<div class="card card-h-2">
										<div class="card-head">
											<div class="d-inline-block m-2 text-medium text-dark font-weight-bold">Graphic Representation</div>
											<div class="d-inline-block m-2 float-right">
												<i class="fa fa-ellipsis-h text-muted d-block"></i>
											</div>
											<div class="clearfix"></div>
										</div>
										<div class="card-body">
											<canvas class="graphic-repersentation-graph-canvas graph-canvas"></canvas>
										</div>
									</div>
								</div>
								<div class="col-6">
									<div class="card card-h-2">
										<div class="card-head">
											<div class="d-inline-block m-2 text-medium text-dark font-weight-bold">Reference &amp; Vision Comparision</div>
											<div class="d-inline-block m-2 float-right">
												<i class="fa fa-ellipsis-h text-muted d-block"></i>
											</div>
											<div class="clearfix"></div>
										</div>
										<div class="card-body">
											<canvas class="reference-vision-graph-canvas graph-canvas"></canvas>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="container">
					<div class="card pb-5">
						<div class="card-body pb-5">
							<div class="container h5 text-dark">
								<strong>Pareto of <span class="pareto-option pareto-option-1" style="border-bottom: 3px solid #50e3c2;">Losses</span> by <span class="pareto-option pareto-option-2" style="border-bottom: 3px solid #50e3c2;">Family</span><span class="pareto-option pareto-option-3" style="margin-left: 10px; border-bottom: 3px solid #50e3c2;">(H Mac)</span>
								</strong>
							</div>
							<div class="text-dark text-small font-weight-bold d-inline-block ml-3">
								Comparison of all (insert number of losses here) losses by grouping into their (insert number of families here) families.
							</div>
							<div class="d-inline-block float-right">
								<select class="family-select select-type-input p-1 px-2 rounded text-small font-weight-bold d-block">
									<option value="0">All Families</option>
								</select>
							</div>
							<div class="clearfix"></div>
							<div class="my-2 pareto-graph-canvas-container">
								<canvas class="pareto-graph-canvas"></canvas>
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</div>
</body></html>





















